{% load static %}
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Entrar • Quality Governance Plan</title>
    <link rel="stylesheet" href="{% static 'dashboard/theme.css' %}">
    <link rel="stylesheet" href="{% static 'dashboard/login.css' %}">
</head>
<body class="login-body">
    <main class="login-wrapper">
        <section class="login-card" role="dialog" aria-labelledby="titulo-login">
            <div class="brand">
                <img src="{% static 'dashboard/img/logo.png' %}" alt="Quality Governance Plan" class="brand-logo" onerror="this.style.display='none'">
                <h1 id="titulo-login" class="brand-title">QUALITY GOVERNANCE PLAN</h1>
            </div>

            {% if form.non_field_errors %}
            <div class="login-alert">
                {% for err in form.non_field_errors %}<div>{{ err }}</div>{% endfor %}
            </div>
            {% endif %}

            <form method="post" class="login-form" novalidate>
                {% csrf_token %}
                <input type="hidden" name="next" value="{{ next }}" />

                        <div class="form-group">
                            <label for="id_username">Usuário</label>
                            <input id="id_username" name="username" type="text" autocomplete="username" required />
                            {% if form.username.errors %}<small class="field-error">{{ form.username.errors|striptags }}</small>{% endif %}
                        </div>

                        <div class="form-group password-group">
                            <label for="id_password">Senha</label>
                            <input id="id_password" name="password" type="password" autocomplete="current-password" required />
                            <button type="button" class="toggle-password" aria-label="Mostrar senha" aria-pressed="false">
                                <svg class="icon-eye" xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                                    <path d="M12 5c-7 0-11 7-11 7s4 7 11 7 11-7 11-7-4-7-11-7zm0 12a5 5 0 1 1 0-10 5 5 0 0 1 0 10z"></path>
                                </svg>
                            </button>
                            {% if form.password.errors %}<small class="field-error">{{ form.password.errors|striptags }}</small>{% endif %}
                        </div>

                <div class="actions">
                    <button type="submit" class="btn-login">Entrar</button>
                    <a class="btn-link" href="{% url 'password_reset' %}">Esqueci minha senha</a>
                </div>
            </form>

            <footer class="login-footer">© {{ now|default:None|date:'Y' }} Quality Governance Plan</footer>
        </section>
    </main>
    <script>
        (function(){
            const btn = document.querySelector('.toggle-password');
            const input = document.getElementById('id_password');
            if(btn && input){
                btn.addEventListener('click', function(){
                    const show = input.getAttribute('type') === 'password';
                    input.setAttribute('type', show ? 'text' : 'password');
                    this.setAttribute('aria-pressed', String(show));
                    this.setAttribute('aria-label', show ? 'Ocultar senha' : 'Mostrar senha');
                    this.classList.toggle('active', show);
                });
            }
        })();
    </script>
</body>
</html>
