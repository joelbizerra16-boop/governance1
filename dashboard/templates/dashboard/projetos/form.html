{% extends 'dashboard/base.html' %}

{% block title %}{% if projeto %}Editar Projeto{% else %}Criar Projeto{% endif %}{% endblock %}

{% block content %}
    <h2 class="titulo-form">{% if projeto %}Editar Projeto{% else %}Criar Projeto{% endif %}</h2>
    <form method="post" class="form-projeto-tres-colunas">
        {% csrf_token %}
        <div class="form-buttons" style="margin-bottom:18px; display:flex; gap:12px;">
            <button type="submit" class="btn-salvar">Salvar</button>
            <a href="/projetos/" class="btn-voltar">Cancelar</a>
        </div>
        <div class="form-projeto-grid" style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:48px;">
            <div style="grid-column: 1 / span 3; margin-bottom: 18px; background: var(--surface-50); border-radius: 8px; padding: 12px 18px; font-weight: bold; font-size: 1.1em; color: var(--primary-600); box-shadow: 0 2px 8px rgba(0,0,0,0.08);">
                {% if projeto %}
                    ID do Projeto: {{ projeto.id }}
                {% else %}
                    Novo Projeto / PLC
                {% endif %}
            </div>
            <!-- Coluna 1 -->
            <div class="form-coluna">
                <div class="form-group">
                    <label>Nome do projeto:</label>
                    <input type="text" name="nome" value="{{ projeto.nome|default:'' }}" required>
                </div>
                <div class="form-group">
                    <label>Responsável:</label>
                    <input type="text" name="responsavel" value="{{ projeto.responsavel|default:'' }}" required>
                </div>
                <div class="form-group">
                    <label>Área responsável:</label>
                    <select name="area_responsavel" required>
                        {% for area, label in areas %}
                        <option value="{{ area }}" {% if projeto.area_responsavel == area %}selected{% endif %}>{{ label }}</option>
                        {% endfor %}
                    </select>
                </div>
            </div>
            <!-- Coluna 2 -->
            <div class="form-coluna">
                <div class="form-group">
                    <label>Data início:</label>
                    <input type="date" name="data_inicio" value="{{ projeto.data_inicio|date:'Y-m-d' }}" required>
                </div>
                <div class="form-group">
                    <label>Unidade:</label>
                    <select name="unidade" required>
                        <option value="" disabled selected>Selecione...</option>
                        {% for unidade, label in unidades %}
                        <option value="{{ unidade }}" {% if projeto.unidade == unidade %}selected{% endif %}>{{ label }}</option>
                        {% endfor %}
                    </select>
                </div>
            </div>
            <!-- Coluna 3 -->
            <div class="form-coluna">
                <div class="form-group">
                    <label>Data fim:</label>
                    <input type="date" name="data_fim" value="{{ projeto.data_fim|date:'Y-m-d' }}" required>
                </div>
                <div class="form-group">
                    <label>Tarefas associadas:</label>
                    <select name="tarefas_associadas" multiple style="width:100%; min-height:90px;">
                        {% for tarefa in tarefas %}
                            <option value="{{ tarefa.id }}" {% if tarefa.id in tarefas_associadas_ids %}selected{% endif %}>{{ tarefa.nome }}</option>
                        {% endfor %}
                    </select>
                    <small>Segure Ctrl (Windows) ou Cmd (Mac) para selecionar múltiplas tarefas.</small>
                </div>
            </div>
        </div>
        <div class="form-group" style="margin-top:18px;">
            <label>Observação:</label>
            <textarea name="observacao" rows="3" style="width:100%;resize:vertical;">{% if projeto %}{{ projeto.observacao|default:'' }}{% endif %}</textarea>
        </div>
        <!-- Botões já estão no topo -->
    </form>
{% endblock %}
